import{H as w,z as fe,r as _,A as ge,L as ye,d as r,K as M,o as u,c as G,C as K,D as J,f as e,e as t,w as o,i as W,m as d,j as i,B as X,l as y,k as be,M as _e,N as ve,x as ke,s as Ve}from"./index.47c6a412.js";function Ce(f){return w({url:"/system/oss/config/list",method:"get",params:f})}function he(f){return w({url:"/system/oss/config/"+f,method:"get"})}function Ke(f){return w({url:"/system/oss/config",method:"post",data:f})}function we(f){return w({url:"/system/oss/config",method:"put",data:f})}function xe(f){return w({url:"/system/oss/config/"+f,method:"delete"})}function Ne(f,g,I){return w({url:"/system/oss/config/changeStatus",method:"put",data:{ossConfigId:f,status:g,configKey:I}})}const Se={class:"app-container"},Ue={class:"dialog-footer"},Pe=fe({name:"OssConfig"}),Ie=Object.assign(Pe,{setup(f){const{proxy:g}=Ve(),{sys_yes_no:I}=g.useDict("sys_yes_no"),$=_([]),V=_(!1),N=_(!1),C=_(!0),S=_(!0),O=_([]),z=_(!0),F=_(!0),D=_(0),R=_(""),v=_([{key:0,label:"\u4E3B\u5EFA",visible:!0},{key:1,label:"\u914D\u7F6Ekey",visible:!1},{key:2,label:"\u8BBF\u95EE\u7AD9\u70B9",visible:!0},{key:3,label:"\u81EA\u5B9A\u4E49\u57DF\u540D",visible:!0},{key:4,label:"\u6876\u540D\u79F0",visible:!0},{key:5,label:"\u524D\u7F00",visible:!0},{key:6,label:"\u57DF",visible:!0},{key:7,label:"\u6876\u6743\u9650\u7C7B\u578B",visible:!0},{key:8,label:"\u72B6\u6001",visible:!0}]),Y=ge({form:{},queryParams:{pageNum:1,pageSize:10,configKey:void 0,bucketName:void 0,status:void 0},rules:{configKey:[{required:!0,message:"configKey\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],accessKey:[{required:!0,message:"accessKey\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:2,max:200,message:"accessKey\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 2 \u548C 100 \u4E4B\u95F4",trigger:"blur"}],secretKey:[{required:!0,message:"secretKey\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:2,max:100,message:"secretKey\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 2 \u548C 100 \u4E4B\u95F4",trigger:"blur"}],bucketName:[{required:!0,message:"bucketName\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:2,max:100,message:"bucketName\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 2 \u548C 100 \u4E4B\u95F4",trigger:"blur"}],endpoint:[{required:!0,message:"endpoint\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:2,max:100,message:"endpoint\u540D\u79F0\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 2 \u548C 100 \u4E4B\u95F4",trigger:"blur"}],accessPolicy:[{required:!0,message:"accessPolicy\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),{queryParams:m,form:n,rules:Z}=ye(Y);function h(){C.value=!0,Ce(m.value).then(s=>{$.value=s.rows,D.value=s.total,C.value=!1})}function ee(){V.value=!1,B()}function B(){n.value={ossConfigId:void 0,configKey:void 0,accessKey:void 0,secretKey:void 0,bucketName:void 0,prefix:void 0,endpoint:void 0,domain:void 0,isHttps:"N",accessPolicy:"1",region:void 0,status:"1",remark:void 0},g.resetForm("ossConfigRef")}function U(){m.value.pageNum=1,h()}function le(){g.resetForm("queryRef"),U()}function te(s){O.value=s.map(a=>a.ossConfigId),z.value=s.length!=1,F.value=!s.length}function ae(){B(),V.value=!0,R.value="\u6DFB\u52A0\u5BF9\u8C61\u5B58\u50A8\u914D\u7F6E"}function T(s){C.value=!0,B();const a=s.ossConfigId||O.value;he(a).then(p=>{C.value=!1,n.value=p.data,V.value=!0,R.value="\u4FEE\u6539\u5BF9\u8C61\u5B58\u50A8\u914D\u7F6E"})}function oe(){g.$refs.ossConfigRef.validate(s=>{s&&(N.value=!0,n.value.ossConfigId!=null?we(n.value).then(a=>{g.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),V.value=!1,h()}).finally(()=>{N.value=!1}):Ke(n.value).then(a=>{g.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),V.value=!1,h()}).finally(()=>{N.value=!1}))})}function ne(s){let a=s.status==="0"?"\u542F\u7528":"\u505C\u7528";g.$modal.confirm('\u786E\u8BA4\u8981"'+a+'""'+s.configKey+'"\u914D\u7F6E\u5417?').then(()=>Ne(s.ossConfigId,s.status,s.configKey)).then(()=>{h(),g.$modal.msgSuccess(a+"\u6210\u529F")}).catch(function(){s.status=s.status==="0"?"1":"0"})}function E(s){const a=s.ossConfigId||O.value;g.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664OSS\u914D\u7F6E\u7F16\u53F7\u4E3A"'+a+'"\u7684\u6570\u636E\u9879?').then(()=>(C.value=!0,xe(a))).then(()=>{C.value=!1,h(),g.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).finally(()=>{C.value=!1})}return h(),(s,a)=>{const p=r("el-input"),c=r("el-form-item"),Q=r("el-option"),se=r("el-select"),k=r("el-button"),j=r("el-form"),H=r("el-col"),ue=r("right-toolbar"),ie=r("el-row"),b=r("el-table-column"),L=r("el-tag"),re=r("el-switch"),de=r("el-table"),ce=r("pagination"),P=r("el-radio"),A=r("el-radio-group"),me=r("el-dialog"),x=M("hasPermi"),pe=M("loading");return u(),G("div",Se,[K(t(j,{model:e(m),ref:"queryRef",inline:!0},{default:o(()=>[t(c,{label:"\u914D\u7F6Ekey",prop:"configKey"},{default:o(()=>[t(p,{modelValue:e(m).configKey,"onUpdate:modelValue":a[0]||(a[0]=l=>e(m).configKey=l),placeholder:"\u914D\u7F6Ekey",clearable:"",style:{width:"200px"},onKeyup:W(U,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(c,{label:"\u6876\u540D\u79F0",prop:"bucketName"},{default:o(()=>[t(p,{modelValue:e(m).bucketName,"onUpdate:modelValue":a[1]||(a[1]=l=>e(m).bucketName=l),placeholder:"\u8BF7\u8F93\u5165\u6876\u540D\u79F0",clearable:"",style:{width:"200px"},onKeyup:W(U,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(c,{label:"\u662F\u5426\u9ED8\u8BA4",prop:"status"},{default:o(()=>[t(se,{modelValue:e(m).status,"onUpdate:modelValue":a[2]||(a[2]=l=>e(m).status=l),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",clearable:"",style:{width:"200px"}},{default:o(()=>[t(Q,{key:"0",label:"\u662F",value:"0"}),t(Q,{key:"1",label:"\u5426",value:"1"})]),_:1},8,["modelValue"])]),_:1}),t(c,null,{default:o(()=>[t(k,{type:"primary",icon:"search",onClick:U},{default:o(()=>[d("\u641C\u7D22")]),_:1}),t(k,{icon:"Refresh",onClick:le},{default:o(()=>[d("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[J,e(S)]]),t(ie,{gutter:10,class:"mb8"},{default:o(()=>[t(H,{span:1.5},{default:o(()=>[K((u(),i(k,{type:"primary",plain:"",icon:"Plus",onClick:ae},{default:o(()=>[d("\u65B0\u589E")]),_:1})),[[x,["system:oss:add"]]])]),_:1},8,["span"]),t(H,{span:1.5},{default:o(()=>[K((u(),i(k,{type:"success",plain:"",icon:"Edit",disabled:e(z),onClick:T},{default:o(()=>[d("\u4FEE\u6539")]),_:1},8,["disabled"])),[[x,["system:oss:edit"]]])]),_:1},8,["span"]),t(H,{span:1.5},{default:o(()=>[K((u(),i(k,{type:"danger",plain:"",icon:"Delete",disabled:e(F),onClick:E},{default:o(()=>[d("\u5220\u9664")]),_:1},8,["disabled"])),[[x,["system:oss:remove"]]])]),_:1},8,["span"]),t(ue,{showSearch:e(S),"onUpdate:showSearch":a[3]||(a[3]=l=>X(S)?S.value=l:null),onQueryTable:h},null,8,["showSearch"])]),_:1}),K((u(),i(de,{data:e($),onSelectionChange:te},{default:o(()=>[t(b,{type:"selection",width:"55",align:"center"}),e(v)[0].visible?(u(),i(b,{key:0,label:"\u4E3B\u5EFA",align:"center",prop:"ossConfigId"})):y("",!0),e(v)[1].visible?(u(),i(b,{key:1,label:"\u914D\u7F6Ekey",align:"center",prop:"configKey"})):y("",!0),e(v)[2].visible?(u(),i(b,{key:2,label:"\u8BBF\u95EE\u7AD9\u70B9",align:"center",prop:"endpoint",width:"200"})):y("",!0),e(v)[3].visible?(u(),i(b,{key:3,label:"\u81EA\u5B9A\u4E49\u57DF\u540D",align:"center",prop:"domain",width:"200"})):y("",!0),e(v)[4].visible?(u(),i(b,{key:4,label:"\u6876\u540D\u79F0",align:"center",prop:"bucketName"})):y("",!0),e(v)[5].visible?(u(),i(b,{key:5,label:"\u524D\u7F00",align:"center",prop:"prefix"})):y("",!0),e(v)[6].visible?(u(),i(b,{key:6,label:"\u57DF",align:"center",prop:"region"})):y("",!0),e(v)[7].visible?(u(),i(b,{key:7,label:"\u6876\u6743\u9650\u7C7B\u578B",align:"center",prop:"accessPolicy"},{default:o(l=>[l.row.accessPolicy==="0"?(u(),i(L,{key:0,type:"warning"},{default:o(()=>[d("private")]),_:1})):y("",!0),l.row.accessPolicy==="1"?(u(),i(L,{key:1,type:"success"},{default:o(()=>[d("public")]),_:1})):y("",!0),l.row.accessPolicy==="2"?(u(),i(L,{key:2,type:"info"},{default:o(()=>[d("custom")]),_:1})):y("",!0)]),_:1})):y("",!0),e(v)[8].visible?(u(),i(b,{key:8,label:"\u662F\u5426\u9ED8\u8BA4",align:"center",prop:"status"},{default:o(l=>[t(re,{modelValue:l.row.status,"onUpdate:modelValue":q=>l.row.status=q,"active-value":"0","inactive-value":"1",onChange:q=>ne(l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):y("",!0),t(b,{label:"\u64CD\u4F5C",align:"center",width:"150","class-name":"small-padding fixed-width"},{default:o(l=>[K((u(),i(k,{link:"",type:"primary",icon:"Edit",onClick:q=>T(l.row)},{default:o(()=>[d("\u4FEE\u6539")]),_:2},1032,["onClick"])),[[x,["system:oss:edit"]]]),K((u(),i(k,{link:"",type:"primary",icon:"Delete",onClick:q=>E(l.row)},{default:o(()=>[d("\u5220\u9664")]),_:2},1032,["onClick"])),[[x,["system:oss:remove"]]])]),_:1})]),_:1},8,["data"])),[[pe,e(C)]]),K(t(ce,{total:e(D),page:e(m).pageNum,"onUpdate:page":a[4]||(a[4]=l=>e(m).pageNum=l),limit:e(m).pageSize,"onUpdate:limit":a[5]||(a[5]=l=>e(m).pageSize=l),onPagination:h},null,8,["total","page","limit"]),[[J,e(D)>0]]),t(me,{title:e(R),modelValue:e(V),"onUpdate:modelValue":a[17]||(a[17]=l=>X(V)?V.value=l:null),width:"800px","append-to-body":""},{footer:o(()=>[be("div",Ue,[t(k,{loading:e(N),type:"primary",onClick:oe},{default:o(()=>[d("\u786E \u5B9A")]),_:1},8,["loading"]),t(k,{onClick:ee},{default:o(()=>[d("\u53D6 \u6D88")]),_:1})])]),default:o(()=>[t(j,{ref:"ossConfigRef",model:e(n),rules:e(Z),"label-width":"120px"},{default:o(()=>[t(c,{label:"\u914D\u7F6Ekey",prop:"configKey"},{default:o(()=>[t(p,{modelValue:e(n).configKey,"onUpdate:modelValue":a[6]||(a[6]=l=>e(n).configKey=l),placeholder:"\u8BF7\u8F93\u5165\u914D\u7F6Ekey"},null,8,["modelValue"])]),_:1}),t(c,{label:"\u8BBF\u95EE\u7AD9\u70B9",prop:"endpoint"},{default:o(()=>[t(p,{modelValue:e(n).endpoint,"onUpdate:modelValue":a[7]||(a[7]=l=>e(n).endpoint=l),placeholder:"\u8BF7\u8F93\u5165\u8BBF\u95EE\u7AD9\u70B9"},null,8,["modelValue"])]),_:1}),t(c,{label:"\u81EA\u5B9A\u4E49\u57DF\u540D",prop:"domain"},{default:o(()=>[t(p,{modelValue:e(n).domain,"onUpdate:modelValue":a[8]||(a[8]=l=>e(n).domain=l),placeholder:"\u8BF7\u8F93\u5165\u81EA\u5B9A\u4E49\u57DF\u540D"},null,8,["modelValue"])]),_:1}),t(c,{label:"accessKey",prop:"accessKey"},{default:o(()=>[t(p,{modelValue:e(n).accessKey,"onUpdate:modelValue":a[9]||(a[9]=l=>e(n).accessKey=l),placeholder:"\u8BF7\u8F93\u5165accessKey"},null,8,["modelValue"])]),_:1}),t(c,{label:"secretKey",prop:"secretKey"},{default:o(()=>[t(p,{modelValue:e(n).secretKey,"onUpdate:modelValue":a[10]||(a[10]=l=>e(n).secretKey=l),placeholder:"\u8BF7\u8F93\u5165\u79D8\u94A5","show-password":""},null,8,["modelValue"])]),_:1}),t(c,{label:"\u6876\u540D\u79F0",prop:"bucketName"},{default:o(()=>[t(p,{modelValue:e(n).bucketName,"onUpdate:modelValue":a[11]||(a[11]=l=>e(n).bucketName=l),placeholder:"\u8BF7\u8F93\u5165\u6876\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(c,{label:"\u524D\u7F00",prop:"prefix"},{default:o(()=>[t(p,{modelValue:e(n).prefix,"onUpdate:modelValue":a[12]||(a[12]=l=>e(n).prefix=l),placeholder:"\u8BF7\u8F93\u5165\u524D\u7F00"},null,8,["modelValue"])]),_:1}),t(c,{label:"\u662F\u5426HTTPS"},{default:o(()=>[t(A,{modelValue:e(n).isHttps,"onUpdate:modelValue":a[13]||(a[13]=l=>e(n).isHttps=l)},{default:o(()=>[(u(!0),G(_e,null,ve(e(I),l=>(u(),i(P,{key:l.value,label:l.value},{default:o(()=>[d(ke(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"\u6876\u6743\u9650\u7C7B\u578B"},{default:o(()=>[t(A,{modelValue:e(n).accessPolicy,"onUpdate:modelValue":a[14]||(a[14]=l=>e(n).accessPolicy=l)},{default:o(()=>[t(P,{label:"0"},{default:o(()=>[d("private")]),_:1}),t(P,{label:"1"},{default:o(()=>[d("public")]),_:1}),t(P,{label:"2"},{default:o(()=>[d("custom")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"\u57DF",prop:"region"},{default:o(()=>[t(p,{modelValue:e(n).region,"onUpdate:modelValue":a[15]||(a[15]=l=>e(n).region=l),placeholder:"\u8BF7\u8F93\u5165\u57DF"},null,8,["modelValue"])]),_:1}),t(c,{label:"\u5907\u6CE8",prop:"remark"},{default:o(()=>[t(p,{modelValue:e(n).remark,"onUpdate:modelValue":a[16]||(a[16]=l=>e(n).remark=l),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Ie as default};
